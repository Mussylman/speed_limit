# === Общие параметры ===
output_dir: "outputs"
show_window: true
fps: 30
device: "cuda"
frame_skip: 3  # каждый 3-й кадр

# === Местоположение камеры ===
address: "ул. Баян Сулу, 5, Астана"
coordinates: [51.146911, 71.379639]  # [lat, lon]

# === YOLO ===
models:
  yolo_model: "models/yolo11n.pt"
yolo_imgsz: 960  # 640=быстро, 960=баланс, 1280=качество

# === Метод измерения скорости ===
speed_method: "homography"  # "homography" или "lines"
speed_limit: 70  # км/ч, превышение = нарушение

homography:
  config_file: "config/homography_config.yaml"
  min_track_points: 5
  smoothing_window: 10
  max_speed_kmh: 200
  min_speed_kmh: 5
  show_bird_eye: true
  speed_correction: 0.43

# =============================================================
# === OCR ФИЛЬТРЫ (чтобы не гонять OCR на каждом кадре) ===
# =============================================================

# --- Фильтр по размеру МАШИНЫ ---
# OCR запускается только если машина достаточно большая (близко к камере)
min_car_height: 40    # мин. высота bbox машины (px)
min_car_width: 30     # мин. ширина bbox машины (px)

# --- Фильтр по размеру НОМЕРА ---
# После детекции номера проверяем его размер
min_plate_width: 85   # мин. ширина номерной таблички (px). < 80 = 14% pass rate
min_plate_height: 10  # мин. высота номерной таблички (px)

# --- Фильтр по качеству OCR ---
min_plate_chars: 7    # мин. символов в номере (KZ=7 или 8)
ocr_conf_threshold: 0.5  # мин. уверенность OCR для принятия результата

# --- Фильтр по формату номера (regex) ---
# KZ формат: 123AB01 (7) или 123ABC01 (8) — 3 цифры + 2-3 буквы + 2 цифры региона
plate_format_regex: "^[0-9]{3}[A-Z]{2,3}[0-9]{2}$"

# --- Интервал между OCR попытками ---
ocr_cooldown_frames: 1  # минимальный интервал — агрессивный OCR

# =============================================================
# === Зоны для линейного метода скорости ===
# =============================================================
line_zones:
  - name: "Down"
    start_line: [[903, 133], [1346, 170]]
    end_line: [[183, 504], [651, 643]]
    distance_m: 10
    direction: "down"
    color: [0, 255, 0]

  - name: "Up"
    start_line: [[1703, 812], [725, 601]]
    end_line: [[1923, 323], [1214, 265]]
    distance_m: 10
    direction: "up"
    color: [255, 0, 0]
